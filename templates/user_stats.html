<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Emoji&display=swap" rel="stylesheet" />
  <style>
    body { margin:0; font-family:"Arial",sans-serif; background:#36393f; color:#fff; }
    .card { width:1024px; padding:20px; background:#2f3136; border-radius:8px; box-sizing:border-box; }
    header { display:flex; align-items:center; gap:20px; margin-bottom:20px; }
    header img { width:64px;height:64px;border-radius:50%; }
    header .info { flex:1; }
    header .info h1 { margin:0; font-size:32px; }
    header .info .sub { color:#b4b4b4; font-size:14px; }
    header .totals { text-align:right; }
    header .totals div { margin-bottom:8px; }
    header .totals small { display:block; color:#b4b4b4; }
    header .totals strong { font-size:24px; }
    .legend { text-align:center; margin-bottom:8px; }
    .legend span { margin: 0 15px; font-size:14px; }
    .legend .dot { display:inline-block; width:10px;height:10px;border-radius:50%; margin-right:4px; vertical-align:middle; }
    .graph { }
    .panels-top, .panels-bottom { display:flex; gap:20px; margin-top:20px; }
    .panel, .panel-simple { background:#2f3136; border-radius:6px; padding:12px; box-sizing:border-box; }
    .panel { flex:1; position:relative; }
    .panel .stripe { position:absolute; left:0;top:0;bottom:0;width:6px;border-radius:6px 0 0 6px; }
    .panel h2, .panel-simple h3 { margin:0 0 10px;font-size:16px;font-weight:normal; }
    .panel ul, .panel-simple ul { list-style:none;padding:0;margin:0; }
    .panel ul li, .panel-simple ul li { display:flex;justify-content:space-between;margin-bottom:6px;font-size:14px; }
    canvas { width:100%;height:300px; display:block; }
  </style>
</head>
<body>
  <div class="card">
    <header>
      <img src="{{ avatar_url }}" alt="Avatar">
      <div class="info">
        <h1>{{ username }}</h1>
        <div class="sub">Made in free</div>
      </div>
      <div class="totals">
        <div>üì® <strong>{{ total_messages }}</strong> <small>Messages</small></div>
        <div>üîä <strong>{{ total_voice }} min</strong> <small>Activit√© vocale</small></div>
      </div>
    </header>

    <div class="legend">
      <span><span class="dot" style="background:#7289DA"></span>Messages</span>
      <span><span class="dot" style="background:#FF6384"></span>Vocale</span>
    </div>
    <div class="graph">
      <canvas id="chart"></canvas>
    </div>

    <div class="panels-top">
      <div class="panel">
        <div class="stripe" style="background:#7289DA"></div>
        <h2>üèÜ Principaux canaux vocaux</h2>
        <ul>
          {% for name, duration in top_voice %}
          <li><span>{{ loop.index }}. {{ name }}</span><span>{{ duration }}</span></li>
          {% endfor %}
        </ul>
      </div>
      <div class="panel">
        <div class="stripe" style="background:#FF6384"></div>
        <h2>üí¨ Principaux canaux messages</h2>
        <ul>
          {% for name, count in top_msgs %}
          <li><span>{{ loop.index }}. {{ name }}</span><span>{{ count }}</span></li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="panels-bottom">
      <div class="panel-simple">
        <h3>üîä Vocale</h3>
        <ul>
          <li><span>1j</span><span>{{ v1 }} min</span></li>
          <li><span>7j</span><span>{{ v7 }} min</span></li>
          <li><span>14j</span><span>{{ v14 }} min</span></li>
        </ul>
      </div>
      <div class="panel-simple">
        <h3>‚úâÔ∏è Messages</h3>
        <ul>
          <li><span>1j</span><span>{{ m1 }} Messages</span></li>
          <li><span>7j</span><span>{{ m7 }} Messages</span></li>
          <li><span>14j</span><span>{{ m14 }} Messages</span></li>
        </ul>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    new Chart(document.getElementById("chart"), {
      type: "line",
      data: {
        labels: {{ time_labels|safe }},
        datasets: [
          { label: "Messages", data: {{ message_data|safe }}, borderColor: "#7289DA", backgroundColor: "rgba(114,137,218,0.3)", fill: true, tension:0.3, pointRadius:4 },
          { label: "Vocale",   data: {{ voice_data|safe }},   borderColor: "#FF6384", backgroundColor: "rgba(255,99,132,0.3)", fill: true, tension:0.3, pointRadius:4 }
        ]
      },
      options: {
        plugins: { legend:{display:false} },
        scales: { x:{ticks:{color:"#7289DA"}}, y:{ticks:{color:"#7289DA"}} },
        animation:false
      }
    });
  </script>
</body>
</html>
